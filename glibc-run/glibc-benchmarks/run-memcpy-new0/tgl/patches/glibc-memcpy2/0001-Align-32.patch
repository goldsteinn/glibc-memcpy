From 991d4831915c8df3d88ad5d40d3f2c77dda3c478 Mon Sep 17 00:00:00 2001
From: Noah Goldstein <goldstein.w.n@gmail.com>
Date: Mon, 11 Oct 2021 20:16:10 -0500
Subject: [PATCH 1/5] Align 32

---
 sysdeps/x86/sysdep.h | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

diff --git a/sysdeps/x86/sysdep.h b/sysdeps/x86/sysdep.h
index 937180c1bd..976076c689 100644
--- a/sysdeps/x86/sysdep.h
+++ b/sysdeps/x86/sysdep.h
@@ -87,8 +87,18 @@ enum cf_protection_level
   _CET_ENDBR;								      \
   CALL_MCOUNT
 
-/* Common entry 16 byte aligns.  */
-#define ENTRY(name) ENTRY_P2ALIGN (name, 4)
+/* Define an entry point visible from C.  */
+#define	ENTRY(name)					      \
+  .globl C_SYMBOL_NAME(name);						      \
+  .type C_SYMBOL_NAME(name),@function;					      \
+  .align ALIGNARG(12);                                 \
+  .align ALIGNARG(6);						      \
+  nop;                                              \
+  .align ALIGNARG(5);						      \
+  C_LABEL(name)								      \
+  cfi_startproc;							      \
+  _CET_ENDBR;								      \
+  CALL_MCOUNT
 
 #undef	END
 #define END(name)							      \
-- 
2.25.1

